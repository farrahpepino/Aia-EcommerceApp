DROP DATABASE IF EXISTS CirracloudDb;
CREATE DATABASE CirracloudDb;
USE CirracloudDb;

CREATE TABLE User (
    id VARCHAR(50) UNIQUE PRIMARY KEY,
    username VARCHAR(35) UNIQUE NOT NULL,
    email VARCHAR(150) NOT NULL,
    password VARCHAR(255) NOT NULL
);

CREATE TABLE Orders (
    orderid VARCHAR(50) PRIMARY KEY,
    customerid VARCHAR(50) NOT NULL,
    orderedat DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    totalquantity INT NOT NULL DEFAULT 0,
    totalcost DECIMAL(10,2) NOT NULL DEFAULT 0,
    FOREIGN KEY (customerid) REFERENCES User(id) ON DELETE CASCADE
);

CREATE TABLE OrderItems (
    orderitemid VARCHAR(50) PRIMARY KEY,
    orderid VARCHAR(50) NOT NULL,
    itemid VARCHAR(50) NOT NULL,
    quantity INT NOT NULL DEFAULT 0,
    itemprice DECIMAL(10,2) NOT NULL DEFAULT 0,
    FOREIGN KEY (orderid) REFERENCES Orders(orderid) ON DELETE CASCADE
);
